<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Banco de Semillas — Dashboard</title>
  <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
  <header class="topbar" role="banner">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Banco de Semillas</h1>
        <p class="subtitle">Invernadero • Gestión y seguimiento</p>
      </div>
    </div>
    <div class="actions-right">
      <input id="search" type="search" placeholder="Buscar semillas, especies, tags…" aria-label="Buscar" />
      <button class="btn ghost" id="refreshBtn" title="Actualizar desde CSV" aria-label="Actualizar">↻</button>
    </div>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tab active" data-view="inventario" role="tab" aria-selected="true">
      <span class="ico ico-seed" aria-hidden="true"></span>
      Inventario
    </button>
    <button class="tab" data-view="calendario" role="tab" aria-selected="false">
      <span class="ico ico-calendar" aria-hidden="true"></span>
      Calendario
    </button>
    <button class="tab" data-view="reportes" role="tab" aria-selected="false">
      <span class="ico ico-report" aria-hidden="true"></span>
      Reportes
    </button>
    <button class="tab" data-view="config" role="tab" aria-selected="false">
      <span class="ico ico-settings" aria-hidden="true"></span>
      Configuración
    </button>
  </nav>

  <main>
    <!-- INVENTARIO -->
    <section class="view active" id="view-inventario" aria-labelledby="Inventario">
      <div class="toolbar">
        <div class="left">
          <button class="btn grad-green" id="addSeedBtn"><span class="ico ico-plus" aria-hidden="true"></span> Añadir semilla</button>
          <input id="filePicker" type="file" accept=".csv,text/csv" hidden>
          <button class="btn grad-blue" id="importBtn"><span class="ico ico-import" aria-hidden="true"></span> Importar CSV</button>
          <button class="btn grad-orange" id="exportBtn"><span class="ico ico-export" aria-hidden="true"></span> Exportar</button>
        </div>
        <div class="right">
          <div class="chips" id="chips">
            <button class="chip" data-filter="interior">Interior</button>
            <button class="chip" data-filter="exterior">Exterior</button>
            <button class="chip" data-filter="rápida">Rápida</button>
            <button class="chip" data-filter="otoño-invierno">Otoño-Invierno</button>
            <button class="chip" data-filter="hidropónico">Hidropónico</button>
            <button class="chip clear" id="clearFilters">Limpiar</button>
          </div>
        </div>
      </div>

      <div id="seed-count" class="count"></div>
      <div id="seed-list" class="grid" aria-live="polite"></div>
      <div id="empty" class="empty hidden">Sin resultados para tu búsqueda / filtros.</div>
    </section>

    <!-- CALENDARIO -->
    <section class="view" id="view-calendario">
      <div class="calendar card">
        <div class="cal-header">
          <h2><span class="ico ico-calendar"></span> Calendario de siembra (sugerido)</h2>
          <div class="legend">
            <span class="pill pill-int">Interior</span>
            <span class="pill pill-ext">Exterior</span>
          </div>
        </div>
        <div class="grid-7">
          <div class="cell"><div class="day">Lun</div><span class="tag int">Siembra interior</span></div>
          <div class="cell"><div class="day">Mar</div><span class="tag ext">Trasplante</span></div>
          <div class="cell"><div class="day">Mié</div><span class="tag ext">Siembra exterior</span></div>
          <div class="cell"><div class="day">Jue</div><span class="tag int">Aclareo</span></div>
          <div class="cell"><div class="day">Vie</div><span class="tag ext">Riego/fertilización</span></div>
          <div class="cell"><div class="day">Sáb</div><span class="tag ext">Control plagas</span></div>
          <div class="cell"><div class="day">Dom</div><span class="tag int">Revisión/registro</span></div>
        </div>
      </div>
    </section>

    <!-- REPORTES -->
    <section class="view" id="view-reportes">
      <div class="card">
        <h2><span class="ico ico-report"></span> Reportes</h2>
        <p>Exporta CSV del inventario actual o imprime la vista.</p>
        <div class="actions">
          <button class="btn grad-purple" id="downloadCSV">Descargar CSV (semillas)</button>
          <button class="btn grad-pink" id="printView">Imprimir</button>
        </div>
      </div>
    </section>

    <!-- CONFIG -->
    <section class="view" id="view-config">
      <div class="card">
        <h2><span class="ico ico-settings"></span> Configuración</h2>
        <p>Reemplaza la URL de CSV por la de tu Google Sheets publicado.</p>
        <pre class="code">const CSV_URL = "data/seeds.csv"; // ← cambia por tu URL de Google Sheets CSV</pre>
        <p><label><input type="checkbox" id="readonlyToggle"> Modo solo lectura (oculta añadir/borrar)</label></p>
      </div>
    </section>
  </main>

  <!-- DETALLE (drawer) -->
  <aside id="detailDrawer" aria-hidden="true">
    <div class="drawer">
      <header>
        <h3 id="detailTitle">Ficha de semilla</h3>
        <button id="closeDrawer" class="btn ghost">Cerrar</button>
      </header>
      <div id="detailBody" class="drawer-body"></div>
    </div>
  </aside>

  <!-- MODAL: Añadir semilla -->
  <dialog id="addSeedModal">
    <form method="dialog" class="modal">
      <header>
        <h3><span class="ico ico-plus"></span> Nueva semilla</h3>
      </header>
      <div class="grid-2">
        <label>Nombre<input required name="name" placeholder="Ej: Lechuga Morada"/></label>
        <label>Especie<input name="species" placeholder="Ej: Lactuca sativa"/></label>
        <label>Germinación mín (días)<input type="number" min="0" name="gmin" value="5"/></label>
        <label>Germinación máx (días)<input type="number" min="0" name="gmax" value="10"/></label>
        <label>Interior<input type="checkbox" name="indoor" checked/></label>
        <label>Exterior<input type="checkbox" name="outdoor" checked/></label>
        <label class="full">Siembra<textarea name="sowing" rows="2" placeholder="Cómo sembrar…"></textarea></label>
        <label class="full">Notas (coma separada)<input name="notes" placeholder="rápida, tolera fresco"/></label>
        <label class="full">Tags (coma separada)<input name="tags" placeholder="interior,rápida"/></label>
      </div>
      <footer class="modal-actions">
        <button class="btn ghost" value="cancel">Cancelar</button>
        <button class="btn grad-green" id="saveSeedBtn" value="default">Guardar</button>
      </footer>
    </form>
  </dialog>

  <footer class="footer">
    <small>© Banco de Semillas — Liceo Bicentenario San Nicolás.</small>
  </footer>

  <script src="js/app_csv_v2.js"></script>
</body>
</html>
